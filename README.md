# ğŸ® Polygon P2P Tic-Tac-Toe

```
                  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— 
                  â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•    â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•    â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•
                     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘            â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘            â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  
                     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘            â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘            â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  
                     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—       â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—       â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
                     â•šâ•â•   â•šâ•â• â•šâ•â•â•â•â•â•       â•šâ•â•   â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â•       â•šâ•â•    â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•

                                         â•”â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•—
                                         â•‘       â•‘       â•‘       â•‘
                                         â•‘   X   â•‘   O   â•‘   X   â•‘
                                         â•‘       â•‘       â•‘       â•‘
                                         â• â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•£
                                         â•‘       â•‘       â•‘       â•‘
                                         â•‘   O   â•‘   X   â•‘   O   â•‘
                                         â•‘       â•‘       â•‘       â•‘
                                         â• â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•£
                                         â•‘       â•‘       â•‘       â•‘
                                         â•‘   X   â•‘   O   â•‘   X   â•‘
                                         â•‘       â•‘       â•‘       â•‘
                                         â•šâ•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•
```

<div align="center">

### ğŸš€ **The First Truly Decentralized P2P Betting Game** ğŸš€

[![Live Demo](https://img.shields.io/badge/ğŸ®_Play_Now-Live_Demo-00DC82?style=for-the-badge)](https://p2p-tic-tac-toe-1063244275551.us-central1.run.app)
[![Smart Contract](https://img.shields.io/badge/ğŸ“œ_Contract-Polygon-8247E5?style=for-the-badge)](https://polygonscan.com/address/0x104739765FD82261F7a5005Af47ec6412484081c)
[![License](https://img.shields.io/badge/License-MIT-yellow?style=for-the-badge)](LICENSE)

**Bet MATIC. Play Tic-Tac-Toe. Winner Takes All.**

[ğŸ® Play Now](https://p2p-tic-tac-toe-1063244275551.us-central1.run.app) â€¢ [ğŸ“– Docs](SPEC.md) â€¢ [ğŸ› Report Bug](https://github.com/88448844/polygon-p2p-tictactoe/issues) â€¢ [âœ¨ Request Feature](https://github.com/88448844/polygon-p2p-tictactoe/issues)

</div>

---

## ğŸ¯ What Is This?

A **peer-to-peer betting platform** where two players can wager MATIC on a Tic-Tac-Toe game. The smart contract acts as **trustless escrow**, holding funds until there's a winner. No house edge. No intermediaries. Just you, your opponent, and the blockchain.

### ğŸŒŸ Why It's Special

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’° Bet Real Money     ğŸ® Play Classic Game     ğŸ† Winner Gets 95%  â”‚
â”‚  ğŸ” Trustless Escrow   âš¡ Instant Payouts      ğŸ‰ Epic Celebrationsâ”‚
â”‚  ğŸŒ Low Fees (5%)      ğŸ’ Polygon Network      âš¡ Fast Settlement  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **ğŸ² No Draws**: If there's a draw, the board auto-resets until someone wins
- **âš¡ Real-Time**: Live updates via polling - see your opponent's moves instantly
- **ğŸ’¸ Fair Play**: Smart contract ensures winner gets 1.9x their bet (5% hosting fee)
- **ğŸ¨ Beautiful UI**: Minimalistic dark theme with confetti celebrations
- **ğŸ“± Mobile Ready**: Play on any device with MetaMask

---

## ğŸš€ Quick Start

### 1ï¸âƒ£ Prerequisites
- [MetaMask](https://metamask.io/) browser extension
- Some MATIC on Polygon Mainnet ([Bridge here](https://wallet.polygon.technology/))

### 2ï¸âƒ£ Play in 60 Seconds

```
1. ğŸŒ Open: https://p2p-tic-tac-toe-1063244275551.us-central1.run.app
2. ğŸ¦Š Connect MetaMask (auto-connects on load)
3. ğŸ’° Create game OR join with Match ID
4. ğŸ® Play Tic-Tac-Toe
5. ğŸ† Winner claims prize!
```

### 3ï¸âƒ£ How to Create a Game

```javascript
// Player A
1. Enter bet amount (e.g., 0.1 MATIC â‰ˆ $0.10)
2. Click "Create Game"
3. Sign MetaMask transaction
4. Share your 6-digit Match ID with opponent
```

### 4ï¸âƒ£ How to Join a Game

```javascript
// Player B  
1. Enter the 6-digit Match ID
2. Enter same bet amount
3. Click "Join Game"
4. Sign MetaMask transaction
5. Game starts!
```

---

## ğŸ’¡ Features

<table>
<tr>
<td width="50%">

### ğŸ® Gameplay
- âœ… Classic Tic-Tac-Toe rules
- âœ… Real-time move updates
- âœ… Auto-restart on draw
- âœ… 3-second confetti celebration
- âœ… Toast notifications for all actions

</td>
<td width="50%">

### ğŸ” Security
- âœ… Smart contract escrow
- âœ… Cryptographic winner verification
- âœ… Backend signature authority
- âœ… Cannot cheat or steal funds
- âœ… Trustless settlement

</td>
- âœ… Auto wallet connection
- âœ… Minimalistic dark theme
- âœ… Fixed 3x3 grid (100px cells)
- âœ… Copy-to-clipboard Match ID
- âœ… Smooth animations

</td>
</tr>
</table>

---

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MetaMask  â”‚â—„â”€â”€â”€â”€â”€â–ºâ”‚   Frontend   â”‚â—„â”€â”€â”€â”€â”€â–ºâ”‚     Backend     â”‚
â”‚  (Polygon)  â”‚       â”‚  (React)     â”‚       â”‚   (Node.js)     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                               â”‚
       â”‚         Deposits & Claims                     â”‚ Auto-signs
       â”‚              â†“                                 â”‚ winners
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  UlaniWager Smart    â”‚
           â”‚  Contract (Polygon)  â”‚
           â”‚  Holds Funds Safely  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tech Stack

| Layer | Technology |
|-------|-----------|
| **Frontend** | React, Vite, ethers.js, canvas-confetti |
| **Backend** | Node.js, Express 4, ethers.js |
| **Blockchain** | Polygon Mainnet |
| **Smart Contract** | Solidity (UlaniWager) |
| **Deployment** | Google Cloud Run |
| **Wallet** | MetaMask |

---

## ğŸ” How It Works

### The Smart Contract (Escrow)

```solidity
// Player A creates game
createWager(matchId) payable
â†’ Locks Player A's MATIC

// Player B joins
joinWager(matchId) payable  
â†’ Locks Player B's MATIC (must match A's bet)

// Winner claims prize
settle(matchId, winner, signature)
â†’ Verifies backend signature
â†’ Pays 95% of total pot to winner (5% hosting fee)
â†’ Winner receives 1.9x their original bet
```

### The Backend (Referee)

```javascript
// Tracks game state
- Board position
- Whose turn
- Win/draw detection

// Signs winners
signature = sign(chainId + matchId + winnerAddress)
â†’ Cryptographic proof of win
â†’ Only backend can create valid signatures
```

### Security Model

**Q: How do we prevent cheating?**

**A: Signature verification!**

```javascript
// Backend signs winner
const signature = backendWallet.sign(
  keccak256(chainId, matchId, winnerAddress)
);

// Contract verifies signature
address signer = ecrecover(signature);
require(signer == TRUSTED_BACKEND_ADDRESS);
// âœ… Only pays if signature is valid
```

ğŸ” **Players can't forge signatures** â†’ Need backend's private key  
ğŸ” **Backend only signs actual winners** â†’ Verified game state  
ğŸ” **Contract mathematically verifies** â†’ Uses `ecrecover`  

---

## ğŸ“Š Game Flow

```mermaid
graph LR
    A[Player A Creates] -->|Deposit MATIC| B[Get Match ID]
    B --> C[Player B Joins]
    C -->|Deposit MATIC| D[Play Tic-Tac-Toe]
    D -->|Win| E[Winner Claims]
    D -->|Draw| F[Board Resets]
    F --> D
    E --> G[Get 2x Bet]
```

---

## ğŸ› ï¸ Local Development

### Prerequisites
- Node.js 18+
- MetaMask with Polygon Mainnet
- Git

### Clone & Install

```bash
git clone https://github.com/88448844/polygon-p2p-tictactoe.git
cd polygon-p2p-tictactoe

# Install backend dependencies
cd backend
npm install

# Install frontend dependencies
cd ../frontend
npm install
```

### Environment Setup

**Backend** (`backend/.env`):
```env
PRIVATE_KEY=your_backend_wallet_private_key_without_0x
NODE_ENV=development
```

> âš ï¸ **IMPORTANT**: Never commit `.env` files! They're in `.gitignore`.

**Frontend** (`frontend/.env`):
```env
VITE_API_URL=http://localhost:3000
```

### Run Locally

```bash
# Terminal 1: Start backend
cd backend
node server.js

# Terminal 2: Start frontend
cd frontend
npm run dev
```

Open http://localhost:5173 and connect MetaMask to Polygon Mainnet!

---

## ğŸš€ Deployment

### Deploy to Google Cloud Run

```bash
# Setup
gcloud auth login
gcloud config set project YOUR_PROJECT_ID

# Create secret for private key
echo -n "your_private_key" | gcloud secrets create BETTING_PRIVATE_KEY --data-file=-

# Deploy
gcloud run deploy p2p-tic-tac-toe \
  --source . \
  --region us-central1 \
  --allow-unauthenticated \
  --set-env-vars "NODE_ENV=production" \
  --set-secrets "PRIVATE_KEY=BETTING_PRIVATE_KEY:latest"
```

See [SPEC.md](SPEC.md) for detailed deployment guide.

---

## ğŸ“– Documentation

- [ğŸ“œ Technical Specification](SPEC.md) - Complete system architecture
- [ğŸ® Walkthrough](walkthrough.md) - Feature guide & testing
- [ğŸ—ï¸ Smart Contract](https://polygonscan.com/address/0x104739765FD82261F7a5005Af47ec6412484081c) - View on PolygonScan

---

## ğŸ¤ Contributing

Contributions are welcome! Here's how:

1. Fork the repo
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

---

## ğŸ“ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## ğŸ‰ Acknowledgments

- **Polygon Network** - For fast & cheap transactions
- **MetaMask** - For seamless wallet integration
- **React & Vite** - For amazing DX
- **ethers.js** - For blockchain interaction
- **Google Cloud Run** - For serverless hosting

---

<div align="center">

## ğŸŒŸ Star this repo if you like it! ğŸŒŸ

**Made with â¤ï¸ for the Polygon community**

[ğŸ® Play Now](https://p2p-tic-tac-toe-1063244275551.us-central1.run.app) â€¢ [ğŸ“– Read Docs](SPEC.md) â€¢ [ğŸ› Report Issues](https://github.com/88448844/polygon-p2p-tictactoe/issues)

```
                                         â•”â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•—
                                         â•‘       â•‘       â•‘       â•‘
                                         â•‘   X   â•‘   O   â•‘   X   â•‘
                                         â•‘       â•‘       â•‘       â•‘
                                         â• â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•£
                                         â•‘       â•‘       â•‘       â•‘
                                         â•‘   O   â•‘   X   â•‘   O   â•‘
                                         â•‘       â•‘       â•‘       â•‘
                                         â• â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•£
                                         â•‘       â•‘       â•‘       â•‘
                                         â•‘   X   â•‘   O   â•‘   X   â•‘
                                         â•‘       â•‘       â•‘       â•‘
                                         â•šâ•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•
```

**ğŸ¯ No draws. Only winners. ğŸ†**

</div>
